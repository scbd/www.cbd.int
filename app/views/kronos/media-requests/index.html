<div class="row">
    <style>
        .media-request-container .inactive {
            background: #fff;
        }

        .media-request-container .active {
            background: #c5dff1 !important;
        }

        .media-request-container h3 {
            font-size: 13px;
            margin-top: 2px;
            margin-bottom: 2px;
        }

        table tr td {
            max-width: 50%
        }

        .chip {
            display: inline-block;
            margin: 2px;
        }
        .panel {
  margin-bottom: 20px;
  background-color: #fff;
  border: 1px solid transparent;
  border-radius: 4px;
  -webkit-box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
}
.panel-body {
  padding: 15px;
}
.panel-heading {
  padding: 10px 15px;
  border-bottom: 1px solid transparent;
  border-top-left-radius: 3px;
  border-top-right-radius: 3px;
}
.panel-heading > .dropdown .dropdown-toggle {
  color: inherit;
}
.panel-title {
  margin-top: 0;
  margin-bottom: 0;
  font-size: 16px;
  color: inherit;
}
.panel-title > a,
.panel-title > small,
.panel-title > .small,
.panel-title > small > a,
.panel-title > .small > a {
  color: inherit;
}
.panel-footer {
  padding: 10px 15px;
  background-color: #f5f5f5;
  border-top: 1px solid #ddd;
  border-bottom-right-radius: 3px;
  border-bottom-left-radius: 3px;
}
.panel > .list-group,
.panel > .panel-collapse > .list-group {
  margin-bottom: 0;
}
.panel > .list-group .list-group-item,
.panel > .panel-collapse > .list-group .list-group-item {
  border-width: 1px 0;
  border-radius: 0;
}
.panel > .list-group:first-child .list-group-item:first-child,
.panel > .panel-collapse > .list-group:first-child .list-group-item:first-child {
  border-top: 0;
  border-top-left-radius: 3px;
  border-top-right-radius: 3px;
}
.panel > .list-group:last-child .list-group-item:last-child,
.panel > .panel-collapse > .list-group:last-child .list-group-item:last-child {
  border-bottom: 0;
  border-bottom-right-radius: 3px;
  border-bottom-left-radius: 3px;
}
.panel > .panel-heading + .panel-collapse > .list-group .list-group-item:first-child {
  border-top-left-radius: 0;
  border-top-right-radius: 0;
}
.panel-heading + .list-group .list-group-item:first-child {
  border-top-width: 0;
}
.list-group + .panel-footer {
  border-top-width: 0;
}
.panel > .table,
.panel > .table-responsive > .table,
.panel > .panel-collapse > .table {
  margin-bottom: 0;
}
.panel > .table caption,
.panel > .table-responsive > .table caption,
.panel > .panel-collapse > .table caption {
  padding-right: 15px;
  padding-left: 15px;
}
.panel > .table:first-child,
.panel > .table-responsive:first-child > .table:first-child {
  border-top-left-radius: 3px;
  border-top-right-radius: 3px;
}
.panel > .table:first-child > thead:first-child > tr:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child {
  border-top-left-radius: 3px;
  border-top-right-radius: 3px;
}
.panel > .table:first-child > thead:first-child > tr:first-child td:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child td:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child td:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child td:first-child,
.panel > .table:first-child > thead:first-child > tr:first-child th:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child th:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child th:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child th:first-child {
  border-top-left-radius: 3px;
}
.panel > .table:first-child > thead:first-child > tr:first-child td:last-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child td:last-child,
.panel > .table:first-child > tbody:first-child > tr:first-child td:last-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child td:last-child,
.panel > .table:first-child > thead:first-child > tr:first-child th:last-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child th:last-child,
.panel > .table:first-child > tbody:first-child > tr:first-child th:last-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child th:last-child {
  border-top-right-radius: 3px;
}
.panel > .table:last-child,
.panel > .table-responsive:last-child > .table:last-child {
  border-bottom-right-radius: 3px;
  border-bottom-left-radius: 3px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child {
  border-bottom-right-radius: 3px;
  border-bottom-left-radius: 3px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child td:first-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child td:first-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child td:first-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child td:first-child,
.panel > .table:last-child > tbody:last-child > tr:last-child th:first-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child th:first-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child th:first-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child th:first-child {
  border-bottom-left-radius: 3px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child td:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child td:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child td:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child td:last-child,
.panel > .table:last-child > tbody:last-child > tr:last-child th:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child th:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child th:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child th:last-child {
  border-bottom-right-radius: 3px;
}
.panel > .panel-body + .table,
.panel > .panel-body + .table-responsive,
.panel > .table + .panel-body,
.panel > .table-responsive + .panel-body {
  border-top: 1px solid #ddd;
}
.panel > .table > tbody:first-child > tr:first-child th,
.panel > .table > tbody:first-child > tr:first-child td {
  border-top: 0;
}
.panel > .table-bordered,
.panel > .table-responsive > .table-bordered {
  border: 0;
}
.panel > .table-bordered > thead > tr > th:first-child,
.panel > .table-responsive > .table-bordered > thead > tr > th:first-child,
.panel > .table-bordered > tbody > tr > th:first-child,
.panel > .table-responsive > .table-bordered > tbody > tr > th:first-child,
.panel > .table-bordered > tfoot > tr > th:first-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > th:first-child,
.panel > .table-bordered > thead > tr > td:first-child,
.panel > .table-responsive > .table-bordered > thead > tr > td:first-child,
.panel > .table-bordered > tbody > tr > td:first-child,
.panel > .table-responsive > .table-bordered > tbody > tr > td:first-child,
.panel > .table-bordered > tfoot > tr > td:first-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > td:first-child {
  border-left: 0;
}
.panel > .table-bordered > thead > tr > th:last-child,
.panel > .table-responsive > .table-bordered > thead > tr > th:last-child,
.panel > .table-bordered > tbody > tr > th:last-child,
.panel > .table-responsive > .table-bordered > tbody > tr > th:last-child,
.panel > .table-bordered > tfoot > tr > th:last-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > th:last-child,
.panel > .table-bordered > thead > tr > td:last-child,
.panel > .table-responsive > .table-bordered > thead > tr > td:last-child,
.panel > .table-bordered > tbody > tr > td:last-child,
.panel > .table-responsive > .table-bordered > tbody > tr > td:last-child,
.panel > .table-bordered > tfoot > tr > td:last-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > td:last-child {
  border-right: 0;
}
.panel > .table-bordered > thead > tr:first-child > td,
.panel > .table-responsive > .table-bordered > thead > tr:first-child > td,
.panel > .table-bordered > tbody > tr:first-child > td,
.panel > .table-responsive > .table-bordered > tbody > tr:first-child > td,
.panel > .table-bordered > thead > tr:first-child > th,
.panel > .table-responsive > .table-bordered > thead > tr:first-child > th,
.panel > .table-bordered > tbody > tr:first-child > th,
.panel > .table-responsive > .table-bordered > tbody > tr:first-child > th {
  border-bottom: 0;
}
.panel > .table-bordered > tbody > tr:last-child > td,
.panel > .table-responsive > .table-bordered > tbody > tr:last-child > td,
.panel > .table-bordered > tfoot > tr:last-child > td,
.panel > .table-responsive > .table-bordered > tfoot > tr:last-child > td,
.panel > .table-bordered > tbody > tr:last-child > th,
.panel > .table-responsive > .table-bordered > tbody > tr:last-child > th,
.panel > .table-bordered > tfoot > tr:last-child > th,
.panel > .table-responsive > .table-bordered > tfoot > tr:last-child > th {
  border-bottom: 0;
}
.panel > .table-responsive {
  margin-bottom: 0;
  border: 0;
}
.panel-group {
  margin-bottom: 20px;
}
.panel-group .panel {
  margin-bottom: 0;
  border-radius: 4px;
}
.panel-group .panel + .panel {
  margin-top: 5px;
}
.panel-group .panel-heading {
  border-bottom: 0;
}
.panel-group .panel-heading + .panel-collapse > .panel-body,
.panel-group .panel-heading + .panel-collapse > .list-group {
  border-top: 1px solid #ddd;
}
.panel-group .panel-footer {
  border-top: 0;
}
.panel-group .panel-footer + .panel-collapse .panel-body {
  border-bottom: 1px solid #ddd;
}
.panel-default {
  border-color: #ddd;
}
.panel-default > .panel-heading {
  color: #333333;
  background-color: #f5f5f5;
  border-color: #ddd;
}
.panel-default > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #ddd;
}
.panel-default > .panel-heading .badge {
  color: #f5f5f5;
  background-color: #333333;
}
.panel-default > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #ddd;
}
.panel-primary {
  border-color: #337ab7;
}
.panel-primary > .panel-heading {
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
}
.panel-primary > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #337ab7;
}
.panel-primary > .panel-heading .badge {
  color: #337ab7;
  background-color: #fff;
}
.panel-primary > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #337ab7;
}
.panel-success {
  border-color: #d6e9c6;
}
.panel-success > .panel-heading {
  color: #3c763d;
  background-color: #dff0d8;
  border-color: #d6e9c6;
}
.panel-success > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #d6e9c6;
}
.panel-success > .panel-heading .badge {
  color: #dff0d8;
  background-color: #3c763d;
}
.panel-success > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #d6e9c6;
}
.panel-info {
  border-color: #bce8f1;
}
.panel-info > .panel-heading {
  color: #31708f;
  background-color: #d9edf7;
  border-color: #bce8f1;
}
.panel-info > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #bce8f1;
}
.panel-info > .panel-heading .badge {
  color: #d9edf7;
  background-color: #31708f;
}
.panel-info > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #bce8f1;
}
.panel-warning {
  border-color: #faebcc;
}
.panel-warning > .panel-heading {
  color: #8a6d3b;
  background-color: #fcf8e3;
  border-color: #faebcc;
}
.panel-warning > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #faebcc;
}
.panel-warning > .panel-heading .badge {
  color: #fcf8e3;
  background-color: #8a6d3b;
}
.panel-warning > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #faebcc;
}
.panel-danger {
  border-color: #ebccd1;
}
.panel-danger > .panel-heading {
  color: #a94442;
  background-color: #f2dede;
  border-color: #ebccd1;
}
.panel-danger > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #ebccd1;
}
.panel-danger > .panel-heading .badge {
  color: #f2dede;
  background-color: #a94442;
}
.panel-danger > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #ebccd1;
}
.panel-body:before,
.panel-body:after{
  display: table;
  content: " ";
}
.panel-body:after{
    clear: both;
}
.label {
    border: 1px solid #000;
  }
label {
  display: inline-block;
  max-width: 100%;
  margin-bottom: 5px;
  font-weight: 700;
}
.label {
  display: inline;
  padding: 0.2em 0.6em 0.3em;
  font-size: 75%;
  font-weight: 700;
  line-height: 1;
  color: #fff;
  text-align: center;
  white-space: nowrap;
  vertical-align: baseline;
  border-radius: 0.25em;
}
a.label:hover,
a.label:focus {
  color: #fff;
  text-decoration: none;
  cursor: pointer;
}
.label:empty {
  display: none;
}
.btn .label {
  position: relative;
  top: -1px;
}
.label-default {
  background-color: #777777;
}
.label-default[href]:hover,
.label-default[href]:focus {
  background-color: #5e5e5e;
}
.label-primary {
  background-color: #337ab7;
}
.label-primary[href]:hover,
.label-primary[href]:focus {
  background-color: #286090;
}
.label-success {
  background-color: #5cb85c;
}
.label-success[href]:hover,
.label-success[href]:focus {
  background-color: #449d44;
}
.label-info {
  background-color: #5bc0de;
}
.label-info[href]:hover,
.label-info[href]:focus {
  background-color: #31b0d5;
}
.label-warning {
  background-color: #f0ad4e;
}
.label-warning[href]:hover,
.label-warning[href]:focus {
  background-color: #ec971f;
}
.label-danger {
  background-color: #d9534f;
}
.label-danger[href]:hover,
.label-danger[href]:focus {
  background-color: #c9302c;
}
    </style>
    <div class="container-fluid">
        <div class="col-8">
            <h2 class="marginless ">
                Media Requests - {{mediaRequestCtrl.conference.Title.en}}<i ng-if="mediaRequestCtrl.loading" class="fa fa-spinner fa-spin"></i>
            </h2>
        </div>
        <div class="col-4">
            <div class="form-group" style="margin-top: 2rem;">
                <select
  

                  id="conference"
                  name="conference"
                  class="form-control"
                  ng-options="conference.Title.en for conference in mediaRequestCtrl.conferences"
                  ng-model="mediaRequestCtrl.conference"
                  ng-change="mediaRequestCtrl.changeConference(mediaRequestCtrl.conference)"

                  >
                </select>

              </div>
        </div>

        <div class="col-12">
            <div class="col-12 panel  panel-default">
                <div class="panel-body " style="background-color:white;">
                    <div class="row">
                        
                        <div class="col-sm-3">
                            <select class="form-control" ng-change="mediaRequestCtrl.refreshRequestList(mediaRequestCtrl.requestStatus)" ng-model="mediaRequestCtrl.requestStatus">
                                <option  value="">All ({{counts.total}})</option>
                                <option value="new">New ({{counts.newRequests}})</option>
                                <option  value="accredited">Accredited ({{counts.accredited}})</option>
                                <option  value="accreditationInProgress">Accreditation in progress ({{counts.accreditationInProgress}})</option>
                                <option  value="rejected">Rejected ({{counts.rejected}})</option>
                                <option  value="draft">Draft (user)({{counts.draft}})</option>
                                <option  value="error">In Error State</option>
                            </select>
                        </div>
                        <div class="col-sm-3">
                            <select class="form-control" ng-change="mediaRequestCtrl.refreshRequestList(mediaRequestCtrl.requestStatus)" ng-model="mediaRequestCtrl.sort.prop">
                                <option  ng-selected="'meta.createdOn' === mediaRequestCtrl.sort.prop"     ng-value="'meta.createdOn'">Created Date</option>
                                <option  ng-selected="'organization.title' === mediaRequestCtrl.sort.prop" ng-value="'organization.title'">Organization Name</option>
                                <option  ng-selected="'meta.modifiedOn' === mediaRequestCtrl.sort.prop"   ng-value="'meta.modifiedOn'">Updated Date</option>
                            </select>
                        </div>
                        <div class="col-sm-3">
                            <select class="form-control" ng-change="mediaRequestCtrl.refreshRequestList(mediaRequestCtrl.requestStatus)" ng-model="mediaRequestCtrl.sort.dir">
                                <option  ng-selected="'asc' === mediaRequestCtrl.sort.dir"     ng-value="'asc'">Ascending</option>
                                <option  ng-selected="'desc' === mediaRequestCtrl.sort.dir" ng-value="'desc'">Descending</option>
                            </select>
                        </div>
                        <div class="col-3 text-right" ng-if="mediaRequestCtrl.requests.length">Total : {{mediaRequestCtrl.requests.length}}</div>
                    </div>

                    <hr>

                    <div class="panel  " ng-repeat="request in mediaRequestCtrl.requests" ng-class="{'panel-info': request.organization._id == mediaRequestCtrl.selectedRequest.organization._id , 'panel-danger': request.contactsOnlyError, 'panel-default': '!request.contactsOnlyError'}">
                        <div class="panel-heading" style="cursor:pointer" ng-click="mediaRequestCtrl.selectRequest(request==mediaRequestCtrl.selectedRequest?null:request); mediaRequestCtrl.selectedRequest.organization.kronosIds.length && mediaRequestCtrl.lookUpKronosOrganizations()">
                            <i class="eco-plus-circled"></i><strong> {{request.organization.title}} </strong>,  
                            <span ng-if="request.organization.acronym">({{request.organization.acronym}}),</span>


                            <em ng-if="request.meta.createdOn">{{request.meta.createdOn| moment:'format':'YYYY-MM-DD'}},</em>
                            <em ng-if="request.organization.address.country">&nbsp;&nbsp;{{request.organization.address.country|lowercase|term}} </em>
                            
                            <div class="pull-right ">
                                <span class="label label-default" ng-if="request.needTags">Need Tags</span>
                                <span class="label label-info" ng-if="request.currentStep=='finished' && !request.accredited && !request.rejected">New</span>
                                <span class="label label-warning" ng-if="request.currentStep!='finished'">Pending</span>
                                <span class="label label-success" ng-if="request.accredited">Accredited</span>
                                <span class="label label-danger"  ng-if="request.rejected">Rejected</span>
                                &nbsp;
                                <i ng-hide="request == mediaRequestCtrl.selectedRequest" class="fa fa-caret-down" aria-hidden="true"></i></a>
                                <i ng-show="request == mediaRequestCtrl.selectedRequest" class="fa fa-caret-up" aria-hidden="true"></i></a>
                            </div>
                            <div>

                            </div>
                        </div>
                        <div class="panel-body" ng-if="request == mediaRequestCtrl.selectedRequest">

                            <h3>Organization</h3>

                            <div class="panel panel-default">
                                <div class="panel-body collapse in show">
                                    <div ng-click="mediaRequestCtrl.selectRequest(request)">
                                        <div class="row" style="border-bottom:1px solid #eee;padding-bottom:5px;">
                                            <div class="col-6" >
                                                <div class="pull-right">

                                                    <div  role="group" class="btn-group btn-group-sm" ng-if="request.currentStep=='finished'">
                                                        <button  ng-if="request.organization.kronosIds.length" type="button" class="btn btn-outline-dark" ng-click="mediaRequestCtrl.updateOrganizationStatus(request, 'accreditate')"
                                                            ng-disabled="request.organization.accredited">
                                                            <i class="fa fa-thumbs-up"></i> Accreditate
                                                        </button>
                                                        <button type="button" class="btn btn-outline-dark" ng-click="mediaRequestCtrl.updateOrganizationStatus(request, 'reject')" ng-disabled="request.organization.rejected">
                                                            <i class="fa fa-thumbs-down"></i> Reject
                                                        </button>
                                                        <button  ng-if="!request.organization.kronosIds.length" type="button" class="btn btn-outline-dark" ng-click="mediaRequestCtrl.sendBack(request)" >
                                                          <i class="fa fa-paper-plane"></i> Send Back
                                                      </button>
                                                    </div>
                                                    <div ng-if="!request.organization.kronosIds.length" class="alert alert-danger">
                                                      <span>Link to kronos before accreditation <br/>or rejection, by searching and the check box</span>
                                                  </div>
                                                </div>
                                                <b>{{request.organization.title}} </b>
                                                <span ng-if="request.organization.acronym">({{request.organization.acronym}})</span>
                                            </div>
                                            <div class="col-6" style="border-left:1px solid #eee;">
                                                Kronos Organization
                                                <i ng-if="request.kronos.loading" class="fa fa-cog fa-spin"></i>
                                                <div class="pull-right" style="display: inline-block;">
                                                    <div class="input-group input-sm" style="width: 200px;padding: 0px;">
                                                        <i ng-if="mediaRequestCtrl.kronos.loading" class="fa fa-cog fa-spin"></i>
                                                        <input style="height:30px" type="text" class="form-control" ng-change="mediaRequestCtrl.searchKronosOrg(request.kronos.search, request)"
                                                            ng-model="request.kronos.search" ng-model-options="{ updateOn: 'default blur', debounce: { 'default': 500, 'blur': 0 } }">
                                                        <span type="button" class="input-group-addon">
                                                            <i class="fa fa-search"></i>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row" style="padding-top:5px" >
                                            <div class="col-6" style="border-right:1px solid #eee;"  
                                            ng-class="{'active':request.organization._id == mediaRequestCtrl.selectedRequest.organization._id}">

                                                <div class="pull-right">
                                                    <span class="label label-success" ng-if="request.accredited">Accredited</span>
                                                    <span class="label label-danger" ng-if="request.rejected">Rejected</span>
                                                    <span class="label label-primary" ng-if="request.organization.kronosIds.length">Linked with kronos</span>
                                                </div>
                                                <div ng-if="request.organization.type"></div>
                                                <address style="margin-bottom:2px!important">
                                                    <div>{{request.organization.address.unitNumber}} {{request.organization.address.streetNumber}}
                                                        {{request.organization.address.street}}
                                                    </div>
                                                    <div ng-if="request.organization.address.locality">{{request.organization.address.locality}},</div>
                                                    <div ng-if="request.organization.address.administrativeArea">{{request.organization.address.administrativeArea}},</div>
                                                    {{request.organization.address.postalCode}}
                                                    <span ng-show="request.organization.address.postalCode">, </span>
                                                    <span style="font-weight:500;">
                                                        <br ng-show="!request.organization.address.postalCode" />{{request.organization.address.country|lowercase|term}}</span>
                                                </address>

                                                <div ng-if="request.organization.phone">
                                                    Phone: {{request.organization.phone}}
                                                </div>
                                                <div ng-if="request.organization.email">
                                                    Email:
                                                    <a translation-url ng-href="mailto:{{request.organization.email}}">{{request.organization.email}}</a>
                                                    <span ng-if="request.organization.emailCc">
                                                        <br>
                                                        <a translation-url ng-href="mailto:{{request.organization.emailCc}}">{{request.organization.emailCc}}</a>
                                                    </span>
                                                </div>
                                                <div ng-if="request.organization.website">
                                                    Website:
                                                    <a translation-url target="_new" ng-href="{{request.organization.website}}">{{request.organization.website}}</a>
                                                </div>


                                                <div ng-show="request.organization.medium">
                                                    Medium:
                                                    <span ng-repeat="item in request.organization.medium">{{item}}
                                                        <span ng-show="!$last">, </span>
                                                    </span>
                                                </div>

                                                <div ng-if="request.organization.type">
                                                    Type:
                                                    <span>{{request.organization.type}}</span>
                                                </div>
                                                <hr/>
                                                <div ng-if="request.organization.attachment">
                                                    <ul class="list">
                                                        <li ng-repeat="item in request.organization.attachment">
                                                            <a target="_blank" ng-href="{{mediaRequestCtrl.attachmentUrl(item.url)}}">{{item.title||item.url}}
                                                                <span ng-if="item.tag">({{item.tag}})</span>
                                                            </a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                            <div class="col-6" style="border-left:1px solid #eee">
                                                <div ng-if="request.kronos">

                                                    <table class="table table-striped table-hover table-condensed">
                                                        <tbody ng-repeat="korg in request.kronos.organizations">
                                                            <tr class="small">
                                                                <td  class="small">
                                                                    <button type="button" class="btn btn-sm btn-outline-dark" ng-click="mediaRequestCtrl.toggle(korg)" ng-if="!korg.showMore">
                                                                        <i class="fa fa-chevron-circle-down"></i>
                                                                    </button>
                                                                    <button type="button" class="btn btn-sm btn-outline-dark" ng-click="mediaRequestCtrl.toggle(korg)" ng-if="korg.showMore">
                                                                        <i class="fa fa-chevron-circle-up"></i>
                                                                    </button>
                                                                    <span>{{korg.name}}</span>
                                                                    <span ng-if="korg.OrganizationAcronym">({{korg.acronym}})</span>
                                                                </td>
                                                                <td>{{korg.country|lowercase|term}}</td>
                                                                <td>

                                                                    <div role="group" class="btn-group pull-right">
                                                                        
                                                                        <button type="button" class="btn btn-sm btn-outline-dark" ng-click="mediaRequestCtrl.linkKronsOrganization(request, korg)" ng-if="!korg.isLinked">
                                                                            <i class="fa fa-square-o"></i>
                                                                        </button>
                                                                        <button type="button" class="btn btn-sm btn-success" ng-click="mediaRequestCtrl.removeKronsOrganization(request, korg)" ng-if="korg.isLinked">
                                                                            <i class="fa fa-check-square"></i>
                                                                        </button>
                                                                        &nbsp;
                                                                        <a type="button" class="btn btn-sm btn-outline-dark" ng-href="https://cbd.kronos-events.net/organizations/{{korg.organizationId}}" target="_blank"><i class="fa fa-external-link"></i></a>
                                                                    </div>
                                                            
                                                                </td>
                                                            </tr>
                                                            <tr ng-if="korg.showMore">
                                                                <td colspan="3">
                                                                        <address style="margin-bottom:2px!important">
                                                                            <div>{{korg.address}} </div>
                                                                            <div ng-if="korg.city">{{korg.city}},</div>
                                                                            <div ng-if="korg.state">{{korg.state}},</div>                                                                        
                                                                            <span ng-show="korg.postalCode"> {{korg.postalCode}}, </span>
                                                                            <div style="font-weight:500;"> {{korg.country|lowercase|term}}</div>
                                                                        </address>
                                                                        <div ng-if="korg.phones.length">
                                                                            Phones: <span ng-repeat="phone in korg.phones"> {{phone}}</span>
                                                                        </div>
                                                                        <div ng-if="korg.emails.length">
                                                                            Emails: <span ng-repeat="email in korg.emails"> {{email}}</span>
                                                                        </div>
                                                                        <div ng-if="korg.webs.length">
                                                                            Websites: <span ng-repeat="web in korg.webs"> {{web}}</span>
                                                                        </div>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                        <tfoot ng-if="request._id == mediaRequestCtrl.selectedRequest._id && !mediaRequestCtrl.hasLinkedOrgs(request)">
                                                            <tr>
                                                                <td>{{mediaRequestCtrl.hasLinkedOrgs(request)}}
                                                                    <button class="btn btn-sm btn-primary" ng-click="mediaRequestCtrl.createKronosOrg(request)">Create Kronos Organization</button>
                                                                </td>
                                                            </tr>
                                                        </tfoot>
                                                    </table>
                                                </div>
                                            </div>

                                            <div class="col-12" ng-if="request.contactsOnlyError">
                                              <a ng-href="#" class="float-right" ng-click="mediaRequestCtrl.loadParticipants(request)">Show contacts</a>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="pull-right">
                                <div ng-if="!request.organization.kronosIds.length  || !request.organization.accredited" class="alert alert-danger"> Organization must be linked with kronos and accredited, in order to accreditate participants.  </div>
                                <a ng-href="#" ng-if="request.organization.kronosIds.length && request.organization.accredited" ng-click="mediaRequestCtrl.loadParticipants(request)">Show all</a>
                            </div>
                            <h4>Participants</h4>

                            <div class="panel panel-info" ng-if="(request.participants && request.showParticipants) || request.loadingParticipants" ng-repeat="participant in request.participants" >
        
                                <div class="panel-body collapse in show" id="mediaRequestCtrl.participants{{$index}}" >
                                    <div class="row">
                                        <!-- <div class="alert alert-warn">
                                            <pre>{{participant | json}}</pre>
                                        </div> -->
                                        <div class="col-12" ng-if="participant.meeting.length">
                                            <passport ng-if="participant.showPassportForm" show="participant.showPassportForm" ng-model="participant.passportForm" participant="participant" request="request" organization="request.organization"></passport>

                                        </div>
                                        <div class="text-center">
                                        <i class="fa fa-spin fa-spinner fa-2x" ng-if="request.loadingParticipants || !(request.participants && request.showParticipants)" />
                                        </div>
                                        <div style="border:1px solid #eee; margin:5px;padding:5px; " ng-click="mediaRequestCtrl.selectParticipant(request, participant)"
                                            class="">

                                            <table class="table inactive" width="100%">
                                                <colgroup>
                                                    <col style="width: 50%" />
                                                    <col style="width: 50%" />
                                                </colgroup>
                                                <tbody>
                                                    <tr >
                                                        <td ng-class="{'active':participant._id == mediaRequestCtrl.selectedParticipant._id, 'text-right': participant.meeting.length}" >
                                                            <h3 ng-if="!participant.meeting.length">Contact Only</h3>
                                                            <div ng-if="participant.meeting.length && participant.kronosId" role="group" class="btn-group btn-grousm" ng-if="request.currentStep=='finished'">
                                                                <div ng-if="!participant.kronosId" class="alert alert-danger">

                                                                    <span>Link to kronos before accreditation <br/>or rejection, by searching and the check box</span>
                                                                </div>
                                                                <button   ng-if="participant.kronosId && !participant.passport" type="button" class="btn btn-danger" ng-click="participant.showPassportForm=!participant.showPassportForm;"  >
                                                                    <i class="fa fa-id-card-o "></i> Passport
                                                                </button>
                                                                <button  ng-if="participant.kronosId " type="button" class="btn btn-outline-dark" ng-click="mediaRequestCtrl.updateParticipantStatus(participant, request,'accreditate')"
                                                                    ng-disabled="participant.accredited || !participant.passport">
                                                                    <i class="fa fa-thumbs-up"></i> Accreditate
                                                                </button>
                                                                <button   ng-if="participant.kronosId " type="button" class="btn btn-outline-dark" ng-click="mediaRequestCtrl.updateParticipantStatus(participant, request, 'reject')" 
                                                                ng-disabled="participant.rejected">
                                                                    <i class="fa fa-thumbs-down"></i> Reject
                                                                </button>


                                                                
                                                            </div>
                                                        </td>
                                                        <td ng-show="participant.meeting.length">
                                                            Kronos Contact
                                                            <i ng-if="participant.kronos.loading && !participant.kronos.contacts.length" class="fa fa-cog fa-spin"></i>
                                                            <div class="pull-right" style="display: inline-block;">
                                                                <div class="input-group input-sm" style="width: 200px;padding:0px">
                                                                    <input style="height:30px" type="text" class="form-control" ng-change="mediaRequestCtrl.searchKronosContact(participant.kronos.search, participant, request)"
                                                                        ng-model="participant.kronos.search" ng-model-options="{ updateOn: 'default blur', debounce: { 'default': 500, 'blur': 0 } }">
                                                                    <span type="button" class="input-group-addon">
                                                                        <i class="fa fa-search"></i>
                                                                    </span>
                                                                </div>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td  ng-class="{'active':participant._id == mediaRequestCtrl.selectedParticipant._id}">
                                                            <div class="pull-right">
                                                                <span class="label label-success" ng-if="participant.passport">Passport in Kronos</span>
                                                                <span class="label label-default" ng-if="participant.isOnline">Online</span>
                                                                <span class="label label-default" ng-if="participant.needsVisa">Visa</span>
                                                                <span class="label label-success" ng-if="participant.accredited">Accredited</span>
                                                                <span class="label label-danger" ng-if="participant.rejected">Rejected</span>
                                                                <span class="label label-primary" ng-if="participant.kronosId">Nominated in kronos</span>
                                                                <span class="label label-primary" ng-if="request.focalPoint == participant._id">Focal point</span>
                                                                <span class="label label-primary" ng-if="request.head == participant._id">Head</span>
                                                                <span class="label label-info" ng-if="participant.requestType">{{participant.requestType}}</span>
                                                            </div>
                                                            <div>
                                                                <strong>
                                                                    <span style="font-weight:800;">{{participant.title}} {{participant.firstName}} {{participant.lastName}}</span>
                                                                </strong>
                                                            </div>
                                                            <div>
                                                                {{participant.organizationName}}
                                                            </div>
                                                            <div>
                                                                {{participant.designation}}
                                                                <span ng-show="participant.designationOther">({{participant.designationOther}})</span>
                                                                <span ng-show="participant.designation && participant.department">, </span> {{participant.department}}
                                                            </div>
                                                            <div ng-if="participant.nationality">
                                                                <span style="font-weight:500;">{{participant.nationality|lowercase|term}}</span>
                                                            </div>
                                                            <div class="text-left"><hr/ ></div>
                                                            <table>
                                                                <tr ng-if="participant.dateOfBirth">
                                                                    <td>Date of birth</td>
                                                                    <td>{{participant.dateOfBirth}}</td>
                                                                </tr>
                                                                <tr ng-if="participant.passportNumber">
                                                                    <td>Passport number</td>
                                                                    <td>{{participant.passportNumber }}</td>
                                                                </tr>
                                                                <tr ng-if="participant.phone">
                                                                    <td>Phone</td>
                                                                    <td>{{participant.phone}}</td>
                                                                </tr>
                                                                <tr>
                                                                    <td>Email</td>
                                                                    <td>{{participant.email}}</td>
                                                                </tr>
                                                                <!-- <tr>
                                                                                            <td></td><td></td>
                                                                                        </tr> -->
                                                            </table>
                                                            <div ng-if="participant.address">
                                                                <address style="margin-bottom:2px!important">
                                                                    <div>{{participant.address.unitNumber}} {{participant.address.streetNumber}}
                                                                        {{participant.address.street}}
                                                                    </div>
                                                                    <div ng-if="participant.address.locality">{{participant.address.locality}},</div>
                                                                    <div ng-if="participant.address.administrativeArea">{{participant.address.administrativeArea}},</div>
                                                                    {{participant.address.postalCode}}
                                                                    <span ng-show="participant.address.postalCode">, </span>
                                                                    <span style="font-weight:500;">
                                                                        <br ng-show="!participant.address.postalCode" />{{participant.address.country|lowercase|term}}</span>
                                                                </address>
                                                            </div>
                                                            
                                                            <div ng-if="participant.attachment.length">
                                                                <hr/>
                                                                <label>Attachments</label>
                                                                <ul class="list">
                                                                    <li ng-repeat="item in participant.attachment">
                                                                        <a target="_blank" ng-href="{{mediaRequestCtrl.attachmentUrl(item.url)}}">{{item.title||item.url}}
                                                                            <span ng-if="item.tag">({{item.tag}})</span>
                                                                        </a>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                            <div ng-if="participant.meeting.length">
                                                                <hr/>
                                                                <label>Participating Meetings</label>
                                                                <table class="table table-striped">
                                                                    <tr ng-repeat="item in participant.meeting">
                                                                        <td>
                                                                            {{mediaRequestCtrl.meetings[item].EVT_CD}}
                                                                        </td>
                                                                        <td>

                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </div>
                                                        </td>
                                                        <td ng-show="participant.meeting.length" style="border-left:1px solid #eee">                                                        
                                                            <table class="table table-striped table-hover table-condensed">
                                                                <tbody ng-repeat="kctc in participant.kronos.contacts">
                                                                    <tr ng-class="{'active':kctc.isLinked}">
                                                                        <td>
                                                                            <button type="button" class="btn btn-sm" ng-click="mediaRequestCtrl.toggle(kctc)" ng-if="!kctc.showMore">
                                                                                <i class="fa fa-chevron-circle-down"></i>
                                                                            </button>
                                                                            <button type="button" class="btn btn-sm" ng-click="mediaRequestCtrl.toggle(kctc)" ng-if="kctc.showMore">
                                                                                <i class="fa fa-chevron-circle-up"></i>
                                                                            </button>
                                                                            {{kctc.firstName}} {{kctc.lastName}}</td>
                                                                        <td>{{kctc.country | lowercase | term}}</td>
                                                                        <td>

                                                                            <div role="group" class="btn-group btn-group-sm pull-right text-nowrap">
                                                                                <button type="button" class="btn" ng-click="mediaRequestCtrl.linkKronosContact(request, participant, kctc)" ng-if="!kctc.isLinked">
                                                                                    <i class="fa fa-square-o"></i>
                                                                                </button>
                                                                                <button type="button" class="btn btn-success" ng-click="mediaRequestCtrl.removeKronosContact(request, participant, kctc)"
                                                                                    ng-if="kctc.isLinked">
                                                                                    <i class="fa fa-check-square"></i>
                                                                                </button>
                                                                                &nbsp;
                                                                                <a ng-if="kctc.isLinked && request.organization.kronosIds.length" ng-href="https://cbd.kronos-events.net/organizations/{{request.organization.kronosIds[0]}}/contacts/{{kctc.contactId}}" target="_blank"><i class="fa fa-external-link fa-2x"></i></a>
                                                                            </div>
                                                                            
                                                                        </td>
                                                                    </tr>

                                                                    <tr ng-if="kctc.showMore">
                                                                        <td colspan="3">
                                                                                <address style="margin-bottom:2px!important">
                                                                                    <div>
                                                                                        <strong>{{kctc.organization.name}}
                                                                                            <span ng-if="kctc.acronym">({{kctc.organization.acronym}})</span>
                                                                                        </strong>
                                                                                    </div>
                                                                                    <div>{{kctc.address}} </div>
                                                                                    <div ng-if="kctc.city">{{kctc.city}},</div>
                                                                                    <div ng-if="kctc.state">{{kctc.state}},</div>                                                                        
                                                                                    <span ng-show="kctc.postalCode"> {{kctc.postalCode}}, </span>
                                                                                    <div style="font-weight:500;"> {{kctc.country|lowercase|term}}</div>
                                                                                </address>
                                                                                <div ng-if="kctc.phones.length">
                                                                                    Phones: <span ng-repeat="phone in kctc.phones"> {{phone}}</span>
                                                                                </div>
                                                                                <div ng-if="kctc.mobiles.length">
                                                                                Phones: <span ng-repeat="phone in kctc.mobiles"> {{phone}}</span>
                                                                                </div>
                                                                                <div ng-if="kctc.emails.length">
                                                                                    Emails: <span ng-repeat="email in kctc.emails"> {{email}}</span>
                                                                                </div>
                                                                                <div ng-if="kctc.webs.length">
                                                                                    Websites: <span ng-repeat="web in kctc.webs"> {{web}}</span>
                                                                                </div>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                                <tfoot ng-if="participant._id == mediaRequestCtrl.selectedParticipant._id && !participant.kronosId && request.currentStep=='finished'">
                                                                    <tr>
                                                                        <td colspan="2">
                                                                            <button class="btn btn-sm btn-primary" ng-click="mediaRequestCtrl.createKronosContact(participant, request)"
                                                                            ng-disabled="!request.organization.kronosIds.length">Create Kronos Contact</button>
                                                                        </td>
                                                                    </tr>
                                                                </tfoot>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    {{mediaRequestCtrl.error}}
</div>
